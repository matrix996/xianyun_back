BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS "disprovinces" (
	"id"	INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	"name"	varchar(255),
	"code"	varchar(255),
	"parentCode"	varchar(255),
	"level"	varchar(255),
	"sort"	varchar(255),
	"created_at"	timestamp DEFAULT CURRENT_TIMESTAMP,
	"updated_at"	timestamp DEFAULT CURRENT_TIMESTAMP
);
INSERT INTO "disprovinces" VALUES (1,'天津市','120000000000','','1','TSN','2019-04-02 08:49:44',1557053545717);
INSERT INTO "disprovinces" VALUES (2,'河北省','130000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (3,'山西省','140000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (4,'内蒙古自治区','150000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (5,'辽宁省','210000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (6,'吉林省','220000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (7,'黑龙江省','230000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (8,'上海市','310000000000','','1','SHA','2019-04-02 08:49:44',1557036601112);
INSERT INTO "disprovinces" VALUES (9,'江苏省','320000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (10,'浙江省','330000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (11,'安徽省','340000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (12,'福建省','350000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (13,'江西省','360000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (14,'山东省','370000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (15,'河南省','410000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (16,'湖北省','420000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (17,'湖南省','430000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (18,'广东省','440000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (19,'广西壮族自治区','450000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (20,'海南省','460000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (21,'重庆市','500000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (22,'四川省','510000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (23,'贵州省','520000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (24,'云南省','530000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (25,'西藏自治区','540000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (26,'陕西省','610000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (27,'甘肃省','620000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (28,'青海省','630000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (29,'宁夏回族自治区','640000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
INSERT INTO "disprovinces" VALUES (30,'新疆维吾尔自治区','650000000000','','1',NULL,'2019-04-02 08:49:44','2019-04-02 08:49:44');
CREATE VIEW "cities_has_bussiness_area" AS SELECT * FROM discities WHERE id in
(SELECT DISTINCT city FROM hotels
WHERE EXISTS (SELECT city, province, business_area FROM hotels GROUP BY city))

UNION

SELECT * FROM disprovinces WHERE id in
(SELECT DISTINCT city FROM hotels
WHERE EXISTS (SELECT city, province, business_area FROM hotels GROUP BY city));
COMMIT;
